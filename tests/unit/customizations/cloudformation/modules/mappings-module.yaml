Parameters:
  RegionName:
    Type: String
  Environment:
    Type: String
    Default: dev

Mappings:
  RegionMap:
    us-east-1:
      AMI: ami-0ff8a91507f77f867
      InstanceType: t2.micro
    us-west-1:
      AMI: ami-0bdb828fd58c52235
      InstanceType: t2.micro
    eu-west-1:
      AMI: ami-047bb4163c506cd98
      InstanceType: t2.micro
  EnvironmentMap:
    dev:
      InstanceType: t2.micro
      MultiAZ: false
    prod:
      InstanceType: m5.large
      MultiAZ: true

Resources:
  EC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: !FindInMap [RegionMap, !Ref RegionName, AMI]
      InstanceType: !FindInMap [EnvironmentMap, !Ref Environment, InstanceType]
      
  RDSInstance:
    Type: AWS::RDS::DBInstance
    Properties:
      Engine: mysql
      MultiAZ: !FindInMap [EnvironmentMap, dev, MultiAZ]
      DBInstanceClass: db.t2.micro
