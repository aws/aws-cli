AWSTemplateFormatVersion: '2010-09-09'
Parameters:
  ServiceConfig:
    Type: Map
    Default:
      services:
        - name: api
          environments:
          - dev
          - prod
        - name: worker
          environments:
          - dev
          - prod
        - name: scheduler
          environments:
          - prod
Outputs:
  ApiDevEndpoint:
    Description: API endpoint for dev environment
    Value: https://api-dev-1.example.com
  ApiProdEndpoint:
    Description: API endpoint for prod environment
    Value: https://api-prod-1.example.com
  WorkerEndpoints:
    Description: Worker endpoints
    Value: https://worker-dev-1.example.com, https://worker-prod-1.example.com
  SchedulerEndpoint:
    Description: Scheduler endpoint
    Value: https://scheduler-prod-1.example.com
Resources:
  Service0Service:
    Type: Test::Service::Instance
    Properties:
      Name: api-dev
      ServiceName: api
      ServiceType: service
      InstanceNumber: '1'
      Environment: dev
  Service1Service:
    Type: Test::Service::Instance
    Properties:
      Name: api-prod
      ServiceName: api
      ServiceType: service
      InstanceNumber: '1'
      Environment: prod
  Service2Service:
    Type: Test::Service::Instance
    Properties:
      Name: worker-dev
      ServiceName: worker
      ServiceType: service
      InstanceNumber: '1'
      Environment: dev
  Service3Service:
    Type: Test::Service::Instance
    Properties:
      Name: worker-prod
      ServiceName: worker
      ServiceType: service
      InstanceNumber: '1'
      Environment: prod
  Service4Service:
    Type: Test::Service::Instance
    Properties:
      Name: scheduler-prod
      ServiceName: scheduler
      ServiceType: service
      InstanceNumber: '1'
      Environment: prod
